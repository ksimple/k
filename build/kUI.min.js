define("kUI",["require","exports","kFundamental","jquery","jquery.migrate"],function(a,b,c,d){function e(){return window.performance&&window.performance.now?Math.floor(window.performance.now())+"-"+Math.floor(1e4*Math.random()):(new Date).valueOf()+"-"+Math.floor(1e4*Math.random())}function f(a){var b=a.match(/(\d*)(.*)/).slice(1),c=b[0],d=b[1];return c=parseInt(c),[c,d]}function g(a,b){b?m[a]=b:delete m[a];var c="";for(var a in m)c+=m[a];n.content(c)}function h(){d(document.body).k("layout")}function i(a){if(a){var b=new c.CssTextBuilder;b.pushSelector("html, body"),b.property("position","absolute"),b.property("width","100%"),b.property("height","100%"),b.property("border","0px"),b.property("margin",0,"px"),b.property("padding",0,"px"),g("body",b.toString()),d(window).on("resize",h)}else g("body"),d(window).off("resize",h)}function j(a){a=d(a).eq(0),(a[0]==window||a[0]==document)&&(a=d(document.body));var b=a.find("[k-type]");a.attr("k-type")&&(b=d(a).add(b));for(var c=0;c<b.length;c++){var e=b.eq(c);if(!e[0]["k-item"])switch(e.attr("k-type")){case"stack":e[0]["k-item"]=new k(e,e.attr("k-options"));break;case"layer":e[0]["k-item"]=new l(e,e.attr("k-options"))}}}var k=function(){function a(a,b){this._direction=b,this._element=a,this._classSelectorName="k-ui-stack-"+e(),this._className="k-ui k-ui-stack "+this._classSelectorName,this._element.addClass(this._className),"vertical"==this._direction?(this._offsetName="top",this._offsetName="top",this._lengthName="height",this._quadratureLengthName="width"):(this._offsetName="left",this._lengthName="width",this._quadratureLengthName="height"),"BODY"==this._element[0].tagName&&i(!0),this.layout(d.k.layoutReason.childSizeChanged)}return a.prototype.layout=function(a){a=a||d.k.layoutReason.selfSizeChanged;var b=this._element.width(),c=this._element.height(),e=this._width!=b||this._height!=c,f=!1;if(f=d.browser.msie&&d.browser.version<9?this._layoutByJavascript(a==d.k.layoutReason.childSizeChanged):this._layoutByCssCalc(a==d.k.layoutReason.childSizeChanged)){for(var g=this._element.find(">div"),h=0;h<g.length;h++){var i=g.eq(h);i.k("layout")}this._element.parent()&&e&&this._element.parent().k("layout",d.k.layoutReason.childSizeChanged)}},a.prototype._layoutByCssCalc=function(a){var b=this._element.width(),e=this._element.height(),h=this._width!=b||this._height!=e;if(!a&&h)return!1;for(var i=this._element.find(">div"),j=new c.CssTextBuilder,k=[],l="",m="",n=0,o=!1,p=0;p<i.length;p++){var q=i.eq(p),r=q.attr("k-ui-stack-"+this._lengthName),s=f(r),t=s[0],u=s[1],v={raw:r,index:p,length:t,unit:u,css:{}};if(k.push(v),"?"==r){if(!o){var w=new c.CssTextBuilder;w.pushSelector("."+this._classSelectorName),w.property("position","relative"),w.pushSelector("."+this._classSelectorName+">*"),w.property("position","absolute"),g(this._classSelectorName,w.toString()),o=!0}var x;q.css("position","relative"),"vertical"==this._direction?x=q[this._lengthName]():(q.css("display","inline-block"),x=q[this._lengthName](),q.css("display","")),q.css("position",""),v.length=x,v.unit="px",l+=""==l?v.length+v.unit:" + "+v.length+v.unit,m+=""==m?v.length+v.unit:" + "+v.length+v.unit}else("px"==v.unit||"%"==v.unit)&&(l+=""==l?v.length+v.unit:" + "+v.length+v.unit,"%"!=v.unit?m+=""==m?v.length+v.unit:" + "+v.length+v.unit:n+=v.length)}for(var y="0px",p=0;p<i.length;p++){var v=k[p];v.css.offset="calc("+y+")","*"==v.raw?(y+=" + (100% - ("+l+"))",v.css.length="calc(100% - ("+l+"))"):"px"==v.unit||"%"==v.unit?(y+=" + "+v.length+v.unit,v.css.length="calc("+v.length+v.unit+")"):"%*"==v.unit&&(y+=" + (100% - ("+l+")) * "+v.length+" / 100",v.css.length="calc((100% - ("+l+")) * "+v.length+" / 100)")}if(JSON.stringify(k)==this._lastChildrenOptions&&h)return!1;j.pushSelector("."+this._classSelectorName),j.property("position","relative"),j.property("min-"+this._lengthName,"calc(("+m+") / "+(100-n)+" * 100)"),d.browser.msie&&j.property("overflow","hidden");for(var p=0;p<i.length;p++){var q=i.eq(p),v=k[p];q.addClass(this._className+"-"+p),j.pushSelector("."+this._classSelectorName+">."+this._classSelectorName+"-"+p),"?"!=v.raw&&j.property(this._lengthName,v.css.length),j.property(this._offsetName,v.css.offset),j.property(this._quadratureLengthName,100,"%"),j.property("position","absolute")}return g(this._classSelectorName,j.toString()),this._width=this._element.width(),this._height=this._element.height(),this._lastChildrenOptions=JSON.stringify(k),!0},a.prototype._layoutByJavascript=function(a){var b=this._element.width(),e=this._element.height(),h=this._width!=b||this._height!=e;if(!a&&!h)return!1;for(var i=this._element.find(">div"),j=null,k=[],l=!1,m=0;m<i.length;m++){var n=i.eq(m),o=n.attr("k-ui-stack-"+this._lengthName),p=f(o),q=p[0],r=p[1],s={raw:o,index:m,length:q,unit:r};if(k.push(s),"?"!=o&&"*"!=o&&"px"!=r&&"%*"!=r&&"%"!=r)throw c.createError(0,"k.ui.Stack","Unsupported unit "+s.raw);if("?"==o){l||(j=new c.CssTextBuilder,j.pushSelector("."+this._classSelectorName),j.property("position","relative"),j.pushSelector("."+this._classSelectorName+">*"),j.property("position","absolute"),g(this._classSelectorName,j.toString()),l=!0);var t;n.css("position","relative"),"vertical"==this._direction?t=n[this._lengthName]():(n.css("display","inline-block"),t=n[this._lengthName](),n.css("display","")),n.css("position",""),s.length=t,s.unit="px"}}if(JSON.stringify(k)==this._lastChildrenOptions&&!h)return!1;j=new c.CssTextBuilder,j.pushSelector("."+this._classSelectorName),j.property("position","relative"),j.property("overflow","hidden");for(var m=0;m<i.length;m++){var n=i.eq(m),s=k[m];n.addClass(this._classSelectorName+"-"+m),("px"==s.unit||"%"==s.unit)&&(j.pushSelector("."+this._classSelectorName+">."+this._classSelectorName+"-"+m),"?"!=s.raw&&j.property(this._lengthName,s.length,s.unit),j.property(this._quadratureLengthName,100,"%"),j.property("position","absolute"))}g(this._classSelectorName,j.toString());for(var u=0,v=this._element[this._lengthName](),m=0;m<i.length;m++){var n=i.eq(m),s=k[m];("?"==s.raw||"px"==s.unit||"%"==s.unit)&&("px"!=s.unit&&(s.length=n[this._lengthName](),s.unit="px"),u+=s.length)}var w=0;u>v&&(u=v);for(var m=0;m<i.length;m++){var s=k[m];"*"==s.raw?(s.length=v-u,s.unit="px"):"%*"==s.unit&&(s.length=(v-u)*s.length/100,s.unit="px"),s.offset=w,w+=s.length}j=new c.CssTextBuilder,j.pushSelector("."+this._classSelectorName),j.property("position","relative"),j.property("overflow","hidden");for(var m=0;m<i.length;m++){var s=k[m];j.pushSelector("."+this._classSelectorName+">."+this._classSelectorName+"-"+m),"?"!=s.raw&&j.property(this._lengthName,s.length,s.unit),j.property(this._offsetName,s.offset,s.unit),j.property(this._quadratureLengthName,100,"%"),j.property("position","absolute")}g(this._classSelectorName,j.toString()),this._width=this._element.width(),this._height=this._element.height(),this._lastChildrenOptions=JSON.stringify(k);for(var m=0;m<i.length;m++){var n=i.eq(m);n.k("layout")}return this._element.parent()&&h&&this._element.parent().k("layout",d.k.layoutReason.childSizeChanged),!0},a}(),l=function(){function a(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];this._element=a,this._classSelectorName="k-ui-layout-"+e(),this._className="k-ui k-ui-layout "+this._classSelectorName,this._element.addClass(this._className),"BODY"==this._element[0].tagName&&i(!0),this.layout(!0)}return a.prototype.layout=function(a){void 0===a&&(a=!1)},a}(),m={},n=new c.DynamicStylesheet("k-"+e());d.fn.extend({k:function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];if(0==arguments.length)for(var d=0;d<this.length;d++)j(this.eq(d));else for(var d=0;d<this.length;d++){if(this.eq(d).attr("k-type")){var e=this[d]["k-item"];if(!e)continue;"function"==typeof e[a]?e[a].apply(e,b):console.warn("method "+a+" doesn't exist on the kItem with type "+this.eq(d).attr("k-type"))}break}}}),d.k={layoutReason:{selfSizeChanged:"selfSizeChanged",childSizeChanged:"childSizeChanged"}}});